@model GaspApp.Models.DashboardViewModels.DashboardIndexViewModel
@{
	ViewData["Title"] = "Dashboard";

	IEnumerable<object> LocaleButtons(Article article)
	{
		foreach (var locale in LocaleConstants.SUPPORTED_LOCALES)
		{
			var content = article.Contents.FirstOrDefault(c => c.Culture == locale);
			if (content != null)
			{
				yield return Html.ActionLink("✏️", "ModifyContent", routeValues: new { articleId = article.Id, contentId = content.Id });
			}
			else
			{
				yield return Html.ActionLink("➕", "CreateContent", routeValues: new { articleId = article.Id, locale = locale });
			}
		}
	}
}

<section class="container">
	<div class="section">
		<h1 class="title">Administration Dashboard</h1>
		<h2 class="subtitle">Manage articles and surveys...</h2>
		<hr />
		<div class="block">
			<h1 class="title is-4">Article Management <a class="button is-link is-small" asp-action="CreateArticle">+ Create</a></h1>
			<table class="table is-fullwidth">
				<thead>
					<tr>
						<th>Slug</th>
						<th>EN</th>
						<th>AR</th>
						<th>CN</th>
						<th>FR</th>
						<th>RU</th>
						<th>ES</th>
						<th>Options</th>
					</tr>
				</thead>
				<tbody>
				@foreach (var art in Model.Articles)
				{
					var locales = art.Contents.Select(c => c.Culture);
					<tr>
						<td><a asp-action="ModifyArticle" asp-route-id="@art.Id">@art.Slug</a></td>
						@foreach (var button in LocaleButtons(art))
						{
							<td>@button</td>
						}
						<td><a asp-action="DeleteArticle" asp-route-id="@art.Id" class="button is-danger is-small">Delete</a></td>
					</tr>
				}
				</tbody>
			</table>
		</div>
		<hr />
		<div class="block">
			<h1 class="title is-4">Survey Management <a class="button is-link is-small" asp-action="CreateSurvey">+ Create</a></h1>
			<table class="table is-fullwidth">
				<thead>
					<th>Description</th>
					<th>Is Active?</th>
					<th>Responses</th>
					<th>Options</th>
				</thead>
				<tbody>
				@foreach (var srv in Model.Surveys)
				{
					<tr>
						<td>@srv.Survey.Description</td>
						<td>@srv.Survey.IsActive()</td>
						<td>@srv.ResponseCount</td>
						<td>
							<a asp-action="ModifySurvey" asp-route-id="@srv.Survey.Id" class="button is-primary is-small">Modify</a>
							<a asp-action="DeleteSurvey" asp-route-id="@srv.Survey.Id" class="button is-danger is-small">Delete</a>
						</td>
					</tr>		
				}
				</tbody>
			</table>
		</div>
	</section>
</div>